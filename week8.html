<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <title>D3 Page Template</title>
        <!--<script type="text/javascript" src="d3/d3.js"></script> -->
        <script type="text/javascript" src="//d3js.org/d3.v3.min.js"></script>
		<script src="http://d3js.org/topojson.v1.min.js"></script>

		<style type="text/css">
            p {
                font-size: 24px;
                font-weight: bold;
				font-family: Helvetica, Arial, sans-serif;
            }
        </style>
    </head>
    <body>		
	

	     <div id="div1"></div>
		 <div id="div2" style="padding-left:30%">
			<button type="button" onclick='update(2)'>Click for k2</button>
			<button type="button" onclick='update(3)'>Click for k3</button>
			<button type="button" onclick='update(4)'>Click for k4</button>
			<button type="button" onclick='update(5)'>Click for k5</button>
			<button type="button" onclick='update(6)'>Click for k6</button>
		 </div>
		<script type="text/javascript">
			var dataset;
			var datacent2;
			var datacent3;
			var datacent4;
			var datacent5;
			var datacent6;

		    var colors = d3.scale.category10();
		    var w = 1000, h = 900
			var projection = d3.geo.mercator()
			    .center([-122.433701, 37.767683])
                .translate([w/2, h/2])
                .scale([300000]);

			var svg = d3.select("#div1")
				.append("svg")
				.attr("width", w)
				.attr("height", h);
				

			var path = d3.geo.path()
                 .projection(projection);

			d3.json("sfpddistricts.json", function(json) {
			    console.log(json);  //Log output to console

				svg.selectAll("path")
				   .data(json.features)
				   .enter()
				   .append("path")
				   .attr("d", path)
				   .style("stroke-width", "2")
				   .style("stroke", "black")
				   .text("yolo")
                   .style("fill", function(d) {
                               return 'lightblue'
					});
					
			var labels = svg.append('g').attr('class', 'labels');

			//Adding labels as seen on http://bl.ocks.org/pgiraud/9f400d54ce2ea7b4f820
			labels.selectAll('.label').data(json.features).enter().append('text')
				.attr('transform', function(d) {
					return "translate(" + path.centroid(d) + ")";
				})
				.style('text-anchor', 'middle')
				.text(function(d) {
					return d.properties.DISTRICT
				});
			labels.selectAll('.label').data(json.features).enter().append('text')
				.attr('transform', function(d) {
					return "translate(" + path.centroid(d) + ")";
				})
				.style('text-anchor', 'middle')
				.text(function(d) {
					return d.properties.DISTRICT
				});

			d3.csv("week8.csv", function(error, data) {
			console.log(data);  //Log output to console
			//data.forEach(function(d) {
			//	d.lat = d.lat;
			//	d.lon = d.lon;
			//	});
			dataset = data
					
			  //console.log(d.lon)
			  //console.log(d.lat)
			
			svg.selectAll("circle")
			   .data(dataset)
			   .enter()
			   .append("circle")

			   .attr("cx", function(d) {
					   return projection([d.lon,d.lat])[0];
			   })
			   .attr("cy", function(d) {
					   return projection([d.lon,d.lat])[1];
			   })
			   .attr("r", function(d) {
					switch(parseInt(d.centroid)) {
						case 0: 
							return 5
						case 2:
							return 25
						case 3:
							return 0
						case 4:
							return 0
						case 5:
							return 0
						case 6:
							return 0
						}
					})
				.style("fill", function(d, i) {
					return colors(d.k2);
				})
			   .style("opacity", function(d) {
					switch(parseInt(d.centroid)) {
						case 0: 
							return 0.75
						case 2:
							return 1
						case 3:
							return 0
						case 4:
							return 0
						case 5:
							return 0
						case 6:
							return 0
						}
					})
				.style("stroke", function(d) {
					switch(parseInt(d.centroid)) {
						case 0: 
							return 
						case 2:
							return "black"
						case 3:
							return 
						case 4:
							return 
						case 5:
							return 
						case 6:
							return 
						}
				});
			 });
			 	});
		

			  
			 
			
	function update(k) {
		var colors = d3.scale.category10();
			 svg.selectAll("circle")
				.data(dataset)
				.transition()
				.duration(5000)
				.attr("cx", function(d) {
				return projection([d.lon,d.lat])[0];
				})
				.attr("cy", function(d) {
				return projection([d.lon,d.lat])[1];
				})
				.style("stroke", function(d) {
					if (d.centroid == k) {
						return "black"
						}
					else {return }
					})
				.attr("r", function(d) {
					if (d.centroid == k) {
						return 25
						}
					if (d.centroid == 0) {
						return 5}
					else {return 0}
					})
				.style("opacity", function(d) {
					if (d.centroid == k) {
						return 1
						}
					if (d.centroid == 0) {
						return 0.75}
					else {return 0}
					})
				.style("fill", function(d) {
					console.log(d.color)
					switch(k) {
					case 2:
						return colors(d.k2);
					case 3:
						return colors(d.k3);
					case 4:
						return colors(d.k4);
					case 5:
						return colors(d.k5);
					case 6:
						return colors(d.k6);
					};
					

				
			 }) };

		</script>
    </body>
</html>
